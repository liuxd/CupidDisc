<!DOCTYPE html>
<html>
  <head>
    <meta charset='UTF-8'>
      <title>Matrimonial Agency</title>
      <script src="javascripts/jquery.min.js" type="text/javascript"></script>
      <link href="stylesheets/index.css" rel="stylesheet" type="text/css" />
    </meta>
  </head>

  <body>
    <div id="boys_and_girls">
    </div>

    <div id="person">
      <img class="candidate" id="Asama" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Asama.png"></img>
      <img class="candidate" id="Benoit" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Benoit.png"></img>
      <img class="candidate" id="Flannel" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Flannel.png"></img>
      <img class="candidate" id="Harold" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Harold.png"></img>
      <img class="candidate" id="Hinata" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Hinata.png"></img>
      <img class="candidate" id="Joker" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Joker.png"></img>
      <img class="candidate" id="Kamui" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Kamui.png"></img>
      <img class="candidate" id="Lazward" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Lazward.png"></img>
      <img class="candidate" id="Leon" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Leon.png"></img>
      <img class="candidate" id="Marx" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Marx.png"></img>
      <img class="candidate" id="Nishiki" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Nishiki.png"></img>
      <img class="candidate" id="Odin" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Odin.png"></img>
      <img class="candidate" id="Ryouma" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Ryouma.png"></img>
      <img class="candidate" id="Saizou" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Saizou.png"></img>
      <img class="candidate" id="Silas" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Silas.png"></img>
      <img class="candidate" id="Suzukaze" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Suzukaze.png"></img>
      <img class="candidate" id="Takumi" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Takumi.png"></img>
      <img class="candidate" id="Tsubaki" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Tsubaki.png"></img>
      <img class="candidate" id="Tsukuyomi" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Tsukuyomi.png"></img>
      <img class="candidate" id="Zero" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Male/Zero.png"></img>

      <p><hr></p>
      <img class="candidate" id="Aqua" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Aqua.png"></img>
      <img class="candidate" id="Belka" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Belka.png"></img>
      <img class="candidate" id="Camilla" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Camilla.png"></img>
      <img class="candidate" id="Charlotte" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Charlotte.png"></img>
      <img class="candidate" id="Elfie" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Elfie.png"></img>
      <img class="candidate" id="Elise" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Elise.png"></img>
      <img class="candidate" id="Felicia" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Felicia.png"></img>
      <img class="candidate" id="Flora" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Flora.png"></img>
      <img class="candidate" id="Hinoka" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Hinoka.png"></img>
      <img class="candidate" id="Kagerou" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Kagerou.png"></img>
      <img class="candidate" id="Kazahana" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Kazahana.png"></img>
      <img class="candidate" id="Luna" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Luna.png"></img>
      <img class="candidate" id="Mozume" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Mozume.png"></img>
      <img class="candidate" id="Nyx" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Nyx.png"></img>
      <img class="candidate" id="Oboro" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Oboro.png"></img>
      <img class="candidate" id="Orochi" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Orochi.png"></img>
      <img class="candidate" id="Pieri" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Pieri.png"></img>
      <img class="candidate" id="Rinka" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Rinka.png"></img>
      <img class="candidate" id="Sakura" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Sakura.png"></img>
      <img class="candidate" id="Setsuna" draggable="true" ondragstart="drag(event)" src="portrait/Parents/Female/Setsuna.png"></img>
    </div>

    <script>
      relation = {
        'Asama' : 'Female/Mitama',
        'Benoit' : 'Male/Ignis',
        'Flannel' : 'Female/Velour',
        'Harold' : 'Male/Lutz',
        'Hinata' : 'Male/Hisame',
        'Joker' : 'Male/Deere',
        'Kamui' : 'Female/Kanna',
        'Lazward' : 'Female/Soleil',
        'Leon' : 'Male/Foleo',
        'Marx' : 'Male/Siegbert',
        'Nishiki' : 'Female/Kinu',
        'Odin' : 'Female/Ophelia',
        'Ryouma' : 'Male/Shinonome',
        'Saizou' : 'Male/Grey',
        'Silas' : 'Female/Sophie',
        'Suzukaze' : 'Female/Midoriko',
        'Takumi' : 'Male/Kisaragi',
        'Tsubaki' : 'Female/Matoi',
        'Tsukuyomi' : 'Female/Shara',
        'Zero' : 'Female/Eponine'
      };

      function sin(degree) {
        return Math.sin(degree * Math.PI / 180);
      }

      function cos(degree) {
        return Math.cos(degree * Math.PI / 180);
      }

      function allowDrop(ev) {
        ev.preventDefault();
      }

      function drag(ev) {
        var img_id = ev.target.id;
        ev.dataTransfer.setData("img_id", img_id);
        var parent_id = $('#' + img_id).parent().attr('id');

        // clear child when moving.
        if (!isNaN(parent_id) && relation[img_id]) {
          var id = parseInt(parent_id) + 40;
          $('#' + id).empty();
        }
      }

      function drop(ev) {
        ev.preventDefault();
        var img_id = ev.dataTransfer.getData("img_id");

        // forbid covering.
        if (isNaN($(ev.target).attr('id'))) {
          alert('There is a person yet.');
          return false;
        }

        var target_id = ev.target.id;

        if (relation[img_id]) {
          if (target_id < 20) {
            $(ev.target).append($('#' + img_id));

            // set child.
            var child_id = parseInt(ev.target.id) + 40;
            var img = '<img class="candidate" src="portrait/Children/' + relation[img_id] + '.png"></img>';
            $('#' + child_id).append(img);
          } else {
            alert('You are father.You should be put in outer circle.');
            return false;
          }
        } else {
          if (target_id >= 20 && target_id < 40) {
            $(ev.target).append($('#' + img_id));
          } else {
            alert('You are mother.You should be put in middle circle.');
            return false;
          }
        }
      }

      function init() {
        var height = $(document).height();
        var width = $(document).width() - 400;
        var radius = 300;
        var radius_inner = 240;
        var radius_child = 180;

        var circle_radius = 25;
        var container = $('#boys_and_girls');

        $('#boys_and_girls').height(height);
        $('#person').css('top', height);

        var x = [
          // The outer circle
          width / 2,
          width / 2 - radius * sin(18),
          width / 2 - radius * sin(36),
          width / 2 - radius * sin(54),
          width / 2 - radius * sin(72),

          width / 2 - radius,
          width / 2 - radius * cos(18),
          width / 2 - radius * cos(36),
          width / 2 - radius * cos(54),
          width / 2 - radius * cos(72),

          width / 2,
          width / 2 + radius * sin(18),
          width / 2 + radius * sin(36),
          width / 2 + radius * sin(54),
          width / 2 + radius * sin(72),

          width / 2 + radius,
          width / 2 + radius * cos(18),
          width / 2 + radius * cos(36),
          width / 2 + radius * cos(54),
          width / 2 + radius * cos(72),

          // The middle circle
          width / 2,
          width / 2 - radius_inner * sin(18),
          width / 2 - radius_inner * sin(36),
          width / 2 - radius_inner * sin(54),
          width / 2 - radius_inner * sin(72),

          width / 2 - radius_inner,
          width / 2 - radius_inner * cos(18),
          width / 2 - radius_inner * cos(36),
          width / 2 - radius_inner * cos(54),
          width / 2 - radius_inner * cos(72),

          width / 2,
          width / 2 + radius_inner * sin(18),
          width / 2 + radius_inner * sin(36),
          width / 2 + radius_inner * sin(54),
          width / 2 + radius_inner * sin(72),

          width / 2 + radius_inner,
          width / 2 + radius_inner * cos(18),
          width / 2 + radius_inner * cos(36),
          width / 2 + radius_inner * cos(54),
          width / 2 + radius_inner * cos(72),

          // The inner circle
          width / 2,
          width / 2 - radius_child * sin(18),
          width / 2 - radius_child * sin(36),
          width / 2 - radius_child * sin(54),
          width / 2 - radius_child * sin(72),

          width / 2 - radius_child,
          width / 2 - radius_child * cos(18),
          width / 2 - radius_child * cos(36),
          width / 2 - radius_child * cos(54),
          width / 2 - radius_child * cos(72),

          width / 2,
          width / 2 + radius_child * sin(18),
          width / 2 + radius_child * sin(36),
          width / 2 + radius_child * sin(54),
          width / 2 + radius_child * sin(72),

          width / 2 + radius_child,
          width / 2 + radius_child * cos(18),
          width / 2 + radius_child * cos(36),
          width / 2 + radius_child * cos(54),
          width / 2 + radius_child * cos(72),
        ];

        var y = [
          // The outer circle
          height / 2 - radius,
          height / 2 - radius * sin(72),
          height / 2 - radius * sin(54),
          height / 2 - radius * sin(36),
          height / 2 - radius * sin(18),

          height / 2,
          height / 2 + radius * sin(18),
          height / 2 + radius * sin(36),
          height / 2 + radius * sin(54),
          height / 2 + radius * sin(72),

          height / 2 + radius,
          height / 2 + radius * cos(18),
          height / 2 + radius * cos(36),
          height / 2 + radius * cos(54),
          height / 2 + radius * cos(72),

          height / 2,
          height / 2 - radius * sin(18),
          height / 2 - radius * sin(36),
          height / 2 - radius * sin(54),
          height / 2 - radius * sin(72),

          // The outer circle
          height / 2 - radius_inner,
          height / 2 - radius_inner * sin(72),
          height / 2 - radius_inner * sin(54),
          height / 2 - radius_inner * sin(36),
          height / 2 - radius_inner * sin(18),

          height / 2,
          height / 2 + radius_inner * sin(18),
          height / 2 + radius_inner * sin(36),
          height / 2 + radius_inner * sin(54),
          height / 2 + radius_inner * sin(72),

          height / 2 + radius_inner,
          height / 2 + radius_inner * cos(18),
          height / 2 + radius_inner * cos(36),
          height / 2 + radius_inner * cos(54),
          height / 2 + radius_inner * cos(72),

          height / 2,
          height / 2 - radius_inner * sin(18),
          height / 2 - radius_inner * sin(36),
          height / 2 - radius_inner * sin(54),
          height / 2 - radius_inner * sin(72),

          // The inner circle
          height / 2 - radius_child,
          height / 2 - radius_child * sin(72),
          height / 2 - radius_child * sin(54),
          height / 2 - radius_child * sin(36),
          height / 2 - radius_child * sin(18),

          height / 2,
          height / 2 + radius_child * sin(18),
          height / 2 + radius_child * sin(36),
          height / 2 + radius_child * sin(54),
          height / 2 + radius_child * sin(72),

          height / 2 + radius_child,
          height / 2 + radius_child * cos(18),
          height / 2 + radius_child * cos(36),
          height / 2 + radius_child * cos(54),
          height / 2 + radius_child * cos(72),

          height / 2,
          height / 2 - radius_child * sin(18),
          height / 2 - radius_child * sin(36),
          height / 2 - radius_child * sin(54),
          height / 2 - radius_child * sin(72),
        ]

        for (var i in x) {
          var _left = x[i] - circle_radius;
          var _top = y[i] - circle_radius;

          var e = '<div id="' + i + '" ondrop="drop(event)" ondragover="allowDrop(event)"></div>';

          var div = $(e).addClass('pos').css('left', _left).css('top', _top);
          div.appendTo(container);
        }
      }

      init();

    </script>
  </body>
</html>
